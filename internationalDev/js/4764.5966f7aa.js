"use strict";(self["webpackChunkeslweb"]=self["webpackChunkeslweb"]||[]).push([[4764],{43902:function(e,a,t){t.r(a),t.d(a,{default:function(){return K}});var l=t(92012),o=t(56995),s=t(66252),i=t(56612);const n=e=>((0,s.dD)("data-v-2a61bb69"),e=e(),(0,s.Cn)(),e),c={class:"bg"},r={class:"profile-container"},d={class:"profile-l-container"},u={class:"profile-r-container"},m={class:"new-deal-t"},g=n((()=>(0,s._)("div",{class:"new-deal-t-l"},"New deal",-1))),p={class:"new-deal-t-r"},h=(0,s.Uk)(" DISCARD "),b=(0,s.Uk)(" SUBMIT "),y={class:"basic-form"},v=n((()=>(0,s._)("div",{class:"basic-form-label"}," Deal information ",-1))),w={class:"deals-location-bg"},_={class:"deals-tabs-container"},f={key:0,class:"deal-location-current-container"},C={key:1,class:"deals-location-container"},k=n((()=>(0,s._)("div",{class:"deals-tips"}," This deal is only available online ",-1))),T=[k],D={key:2,class:"deals-location-container"},F={class:"deals-location-select-container"},L={class:"map-container"},O=n((()=>(0,s._)("div",{id:"mapContainer",class:"basemap"},null,-1))),V=[O],S={key:3,class:"deals-location-container"},j=n((()=>(0,s._)("div",{class:"deals-tips"}," This deal is available online and at the location below ",-1))),W={class:"deals-location-select-container"},N={class:"map-container"},U=n((()=>(0,s._)("div",{id:"mapContainer1",class:"basemap"},null,-1))),$=[U];function x(e,a,t,n,k,O){const U=o.Z,x=(0,s.up)("el-button"),M=(0,s.up)("el-input"),q=(0,s.up)("el-form-item"),I=(0,s.up)("el-col"),H=(0,s.up)("el-row"),P=(0,s.up)("el-option"),A=(0,s.up)("el-select"),J=(0,s.up)("el-form"),Y=(0,s.up)("el-scrollbar"),E=l.Z,K=(0,s.Q2)("loading");return(0,s.wg)(),(0,s.iD)("div",c,[(0,s._)("div",r,[(0,s._)("div",d,[(0,s.Wm)(U)]),(0,s._)("div",u,[(0,s._)("div",m,[g,(0,s._)("div",p,[(0,s.Wm)(x,{class:"new-deal-btn",link:"",round:"",onClick:a[0]||(a[0]=e=>O.discard())},{default:(0,s.w5)((()=>[h])),_:1}),(0,s.Wm)(x,{class:"new-deal-btn",type:"primary",round:"",loading:k.submitLoadingValue,onClick:a[1]||(a[1]=e=>O.submitForm("basicForm"))},{default:(0,s.w5)((()=>[b])),_:1},8,["loading"])])]),(0,s.Wm)(Y,{class:"profile-r-bg-container"},{default:(0,s.w5)((()=>[(0,s._)("div",y,[v,(0,s.Wm)(J,{ref:"basicForm",model:k.basicForm,rules:k.basicRules,"label-width":"120px","label-position":"top",class:"deals-form"},{default:(0,s.w5)((()=>[(0,s.Wm)(H,{gutter:50},{default:(0,s.w5)((()=>[(0,s.Wm)(I,{xs:24,sm:24,md:6,lg:6,xl:6},{default:(0,s.w5)((()=>[(0,s.Wm)(q,{label:"Deal Name",prop:"title"},{default:(0,s.w5)((()=>[(0,s.Wm)(M,{modelValue:k.basicForm.title,"onUpdate:modelValue":a[2]||(a[2]=e=>k.basicForm.title=e),placeholder:"eg. 10% off your first class."},null,8,["modelValue"])])),_:1})])),_:1}),(0,s.Wm)(I,{xs:24,sm:24,md:18,lg:18,xl:18},{default:(0,s.w5)((()=>[(0,s.Wm)(q,{label:"Deal Description",prop:"desc"},{default:(0,s.w5)((()=>[(0,s.Wm)(M,{modelValue:k.basicForm.desc,"onUpdate:modelValue":a[3]||(a[3]=e=>k.basicForm.desc=e),type:"textarea",rows:4,placeholder:"Provide a paragraph or two about the deal and how to redeem it."},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),(0,s.Wm)(H,{gutter:50},{default:(0,s.w5)((()=>[(0,s.Wm)(I,{xs:24,sm:24,md:6,lg:6,xl:6},{default:(0,s.w5)((()=>[(0,s.Wm)(q,{label:"Tags"},{default:(0,s.w5)((()=>[(0,s.Wm)(A,{modelValue:k.selectedTagsValue,"onUpdate:modelValue":a[4]||(a[4]=e=>k.selectedTagsValue=e),teleported:!1,multiple:"","collapse-tags":"","collapse-tags-tooltip":"",filterable:"","allow-create":"",placeholder:"Tags will help find your deal easier","value-key":"id"},{default:(0,s.w5)((()=>[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(k.tagsData,((e,a)=>((0,s.wg)(),(0,s.j4)(P,{key:a,label:e.name_en,value:e},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1}),(0,s.Wm)(I,{xs:24,sm:24,md:18,lg:18,xl:18},{default:(0,s.w5)((()=>[(0,s.Wm)(q,{label:"Deal Location"},{default:(0,s.w5)((()=>[(0,s._)("div",w,[(0,s._)("div",_,[(0,s._)("div",{class:(0,i.C_)(["deals-tabs-l",1===k.dealLocationType?"tags-active":""]),onClick:a[5]||(a[5]=e=>O.changeDealLocationType(1))}," ONLINE ",2),(0,s._)("div",{class:(0,i.C_)(["deals-tabs-m",2===k.dealLocationType?"tags-active":""]),onClick:a[6]||(a[6]=e=>O.changeDealLocationType(2))}," OFFLINE ",2),(0,s._)("div",{class:(0,i.C_)(["deals-tabs-r",3===k.dealLocationType?"tags-active":""]),onClick:a[7]||(a[7]=e=>O.changeDealLocationType(3))}," BOTH ",2)]),k.editDealStatus?((0,s.wg)(),(0,s.iD)("div",f,(0,i.zw)(k.basicForm.location),1)):(0,s.kq)("",!0),1===k.dealLocationType?((0,s.wg)(),(0,s.iD)("div",C,T)):(0,s.kq)("",!0),2===k.dealLocationType?((0,s.wg)(),(0,s.iD)("div",D,[(0,s._)("div",F,[(0,s.Wm)(A,{modelValue:k.countryObj,"onUpdate:modelValue":a[8]||(a[8]=e=>k.countryObj=e),teleported:!1,onChange:O.countryChange,"value-key":"id",filterable:"",placeholder:"Select Country"},{default:(0,s.w5)((()=>[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(k.countryOptions,((e,a)=>((0,s.wg)(),(0,s.j4)(P,{key:a,label:e.name,value:e},null,8,["label","value"])))),128))])),_:1},8,["modelValue","onChange"]),k.provinceOptions.length>0?((0,s.wg)(),(0,s.j4)(A,{key:0,modelValue:k.provinceObj,"onUpdate:modelValue":a[9]||(a[9]=e=>k.provinceObj=e),teleported:!1,"value-key":"id",filterable:"",onChange:O.provinceChange,placeholder:"Select Province"},{default:(0,s.w5)((()=>[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(k.provinceOptions,((e,a)=>((0,s.wg)(),(0,s.j4)(P,{key:a,label:e.name,value:e},null,8,["label","value"])))),128))])),_:1},8,["modelValue","onChange"])):(0,s.kq)("",!0),k.cityOptions.length>0?((0,s.wg)(),(0,s.j4)(A,{key:1,modelValue:k.cityObj,"onUpdate:modelValue":a[10]||(a[10]=e=>k.cityObj=e),teleported:!1,"value-key":"id",filterable:"",onChange:O.cityChange,placeholder:"Select City"},{default:(0,s.w5)((()=>[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(k.cityOptions,((e,a)=>((0,s.wg)(),(0,s.j4)(P,{key:a,label:e.name,value:e},null,8,["label","value"])))),128))])),_:1},8,["modelValue","onChange"])):(0,s.kq)("",!0)]),(0,s.wy)(((0,s.wg)(),(0,s.iD)("div",L,V)),[[K,k.mapLoading]])])):(0,s.kq)("",!0),3===k.dealLocationType?((0,s.wg)(),(0,s.iD)("div",S,[j,(0,s._)("div",W,[(0,s.Wm)(A,{modelValue:k.countryObj,"onUpdate:modelValue":a[11]||(a[11]=e=>k.countryObj=e),teleported:!1,onChange:O.countryChange,"value-key":"id",filterable:"",placeholder:"Select Country"},{default:(0,s.w5)((()=>[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(k.countryOptions,((e,a)=>((0,s.wg)(),(0,s.j4)(P,{key:a,label:e.name,value:e},null,8,["label","value"])))),128))])),_:1},8,["modelValue","onChange"]),k.provinceOptions.length>0?((0,s.wg)(),(0,s.j4)(A,{key:0,modelValue:k.provinceObj,"onUpdate:modelValue":a[12]||(a[12]=e=>k.provinceObj=e),teleported:!1,"value-key":"id",filterable:"",onChange:O.provinceChange,placeholder:"Select Province"},{default:(0,s.w5)((()=>[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(k.provinceOptions,((e,a)=>((0,s.wg)(),(0,s.j4)(P,{key:a,label:e.name,value:e},null,8,["label","value"])))),128))])),_:1},8,["modelValue","onChange"])):(0,s.kq)("",!0),k.cityOptions.length>0?((0,s.wg)(),(0,s.j4)(A,{key:1,modelValue:k.cityObj,"onUpdate:modelValue":a[13]||(a[13]=e=>k.cityObj=e),teleported:!1,"value-key":"id",filterable:"",onChange:O.cityChange,placeholder:"Select City"},{default:(0,s.w5)((()=>[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(k.cityOptions,((e,a)=>((0,s.wg)(),(0,s.j4)(P,{key:a,label:e.name,value:e},null,8,["label","value"])))),128))])),_:1},8,["modelValue","onChange"])):(0,s.kq)("",!0)]),(0,s.wy)(((0,s.wg)(),(0,s.iD)("div",N,$)),[[K,k.map1Loading]])])):(0,s.kq)("",!0)])])),_:1})])),_:1})])),_:1})])),_:1},8,["model","rules"])])])),_:1})])]),(0,s.Wm)(E,{title:k.dealSuccessTitle,description:k.dealSuccessDesc,onClose:O.submitDealSuccess,visible:k.dealSuccessVisible},null,8,["title","description","onClose","visible"])])}var M=t(41836),q=t(6158),I=t.n(q),H=t(19651),P=t.n(H),A=t(42576),J={name:"jobs",components:{meSideMenu:o.Z,submitMessage:l.Z},data(){return{submitLoadingValue:!1,mapLoading:!1,map1Loading:!1,accessToken:"pk.eyJ1Ijoic3JrbGluZ2UiLCJhIjoiY2t2NnR4anI2OWU5NDJ3bWE1dHd3c3h1aSJ9.O0JfjqiyBBkFuf4G-DQ-DQ",mapStyle:"mapbox://styles/mapbox/streets-v11",dealLocationTypeValue:"1",userInfo:{},basicUserInfo:{},tagsData:[],addTagsStatus:!1,selectedTagsValue:[],ownTagsValue:"",ownTagsList:[],selectTagsList:[],selectOwnTagsList:[],selectTagsArr:[],tagsCnData:[],tagsEnData:[],countryObj:{},provinceObj:{},cityObj:{},countryName:"",countryNameCn:"",provinceName:"",provinceNameCn:"",cityName:"",cityNameCn:"",countryOptions:[],provinceOptions:[],cityOptions:[],basicForm:{token:localStorage.getItem("token"),user_id:localStorage.getItem("uid"),deal_id:"",title:"",desc:"",tag:"",is_online:0,location:"",country_id:"",state_id:"",town_id:"",lng:"",lat:"",tags_cn:"",tags_en:""},basicRules:{title:[{required:!0,message:"Please input",trigger:"blur"}],desc:[{required:!0,message:"Please input",trigger:"blur"}]},dealLocationType:1,editDealStatus:!1,dealSuccessTitle:"",dealSuccessDesc:"",dealSuccessVisible:!1}},unmounted(){(0,A.lJ)(),window.onresize=null},mounted(){let e=document.body.clientWidth,a=Math.floor(e);a<=768&&(0,A.lJ)(),window.onresize=()=>{a<=768&&(0,A.lJ)()},this.getTagsList(),this.getAllCountry();let t=this.$route.query.deal_id;t&&(this.basicForm.deal_id=t,this.getDealDetail(t),this.editDealStatus=!0)},methods:{getDealDetail(e){let a=this,t={deal_id:e};(0,M.RT)(t).then((e=>{if(console.log(e),200==e.code){let t=e.message;this.basicForm.title=t.title,this.basicForm.desc=t.desc,this.basicForm.tags_cn=t.tags_cn,this.basicForm.tags_en=t.tags_en,this.basicForm.is_online=t.is_online,this.dealLocationType=t.is_online,this.basicForm.location=t.location,2==t.is_online&&(this.mapLoading=!0,setTimeout((function(){a.initMap(),a.mapLoading=!1}),1e3)),3==t.is_online&&(this.map1Loading=!0,setTimeout((function(){a.initMap1(),a.map1Loading=!1}),1e3));let l=t.tags,o=[],s=this.tagsData,i=[],n=t.tags_en;if(l&&l.length>0&&s&&s.length>0){l.forEach((e=>{let a=s.filter((a=>a.id==e.tag_name));o.push(a[0]),i.push(a[0]["name_en"])}));let e=n.split(",");e.forEach((e=>{let a=i.indexOf(e);-1===a&&o.push(e)})),this.selectedTagsValue=o}}})).catch((e=>{console.log(e)}))},changeDealLocationType(e){this.dealLocationType=e;let a=this;2==e&&(this.mapLoading=!0,setTimeout((function(){a.initMap(),a.mapLoading=!1}),1e3)),3==e&&(this.map1Loading=!0,setTimeout((function(){a.initMap1(),a.map1Loading=!1}),1e3))},initMap(){I().accessToken=this.accessToken;const e=new(I().Map)({container:"mapContainer",center:[121.472644,31.231706],style:this.mapStyle,zoom:12}),a=new(I().NavigationControl);e.addControl(a,"top-right"),e.addControl(new(I().FullscreenControl));const t=new(I().GeolocateControl)({positionOptions:{enableHighAccuracy:!0},trackUserLocation:!0});e.addControl(t,"top-right");const l=new(P())({accessToken:this.accessToken,language:"en-US",mapboxgl:I()});e.addControl(l,"top-left");const o=new(I().Marker);l.on("result",(a=>{console.log(a),o.setLngLat(a.result.center).addTo(e),this.basicForm.location=a.result.place_name,this.basicForm.lng=a.result.center[0],this.basicForm.lat=a.result.center[1]})),l.on("clear",(e=>{console.log(e),this.basicForm.location="",this.basicForm.lng="",this.basicForm.lat=""}))},initMap1(){I().accessToken=this.accessToken;const e=new(I().Map)({container:"mapContainer1",center:[121.472644,31.231706],style:this.mapStyle,zoom:12}),a=new(I().NavigationControl);e.addControl(a,"top-right"),e.addControl(new(I().FullscreenControl));const t=new(I().GeolocateControl)({positionOptions:{enableHighAccuracy:!0},trackUserLocation:!0});e.addControl(t,"top-right");const l=new(P())({accessToken:this.accessToken,language:"en-US",mapboxgl:I()});e.addControl(l,"top-left");const o=new(I().Marker);l.on("result",(a=>{console.log(a),o.setLngLat(a.result.center).addTo(e),this.basicForm.location=a.result.place_name,this.basicForm.lng=a.result.center[0],this.basicForm.lat=a.result.center[1]})),l.on("clear",(e=>{console.log(e),this.basicForm.location="",this.basicForm.lng="",this.basicForm.lat=""}))},getAllCountry(){let e={};(0,M.PQ)(e).then((e=>{console.log(e),200==e.code&&(this.countryOptions=e.message)})).catch((e=>{this.$message.error(e.msg)}))},getAllProvinces(e){let a={country_id:e};(0,M.PQ)(a).then((e=>{console.log(e),200==e.code&&(this.provinceOptions=e.message)})).catch((e=>{this.$message.error(e.msg)}))},getAllCitys(e,a){let t={country_id:e,state_id:a};(0,M.PQ)(t).then((e=>{console.log(e),200==e.code&&(this.cityOptions=e.message)})).catch((e=>{this.$message.error(e.msg)}))},countryChange(e){console.log(e),this.basicForm.state_id=void 0,this.basicForm.town_id=void 0,this.provinceOptions=[],this.cityOptions=[],this.basicForm.country_id=e.id,this.countryName=e.name,this.countryNameCn=e.name,this.getAllProvinces(e.id)},provinceChange(e){console.log(e),this.basicForm.town_id=void 0,this.cityOptions=[],this.basicForm.state=e.id,this.provinceName=e.name,this.provinceNameCn=e.name,this.getAllCitys(this.basicForm.country_id,e.id)},cityChange(e){console.log(e),this.basicForm.town_id=e.id,this.cityName=e.name,this.cityNameCn=e.name},getTagsList(){let e={page:1,limit:1e3};(0,M.dD)(e).then((e=>{console.log(e),200==e.code&&(this.tagsData=e.message.data)})).catch((e=>{console.log(e),e.msg&&this.$message.error(e.msg),e.message&&this.$message.error(e.message)}))},submitForm(e){this.$refs[e].validate((e=>{if(!e)return console.log("error submit!!"),this.$message({type:"warning",message:"Please complete all required fields",grouping:!0}),!1;{let e=this.selectedTagsValue,a=[],t=[],l=[];e.forEach((e=>{"string"===typeof e&&(t.push(e),l.push(e)),"object"===typeof e&&(a.push(e.id),t.push(e.name_en),l.push(e.name_cn))})),this.basicForm.tag=a,l.length>0&&(this.basicForm.tags_cn=l.join(",")),t.length>0&&(this.basicForm.tags_en=t.join(",")),this.basicForm.is_online=this.dealLocationType,this.$loading({text:"Loading..."});let o=Object.assign({},this.basicForm);(0,M.$z)(o).then((e=>{200==e.code&&(this.$loading().close(),this.dealSuccessTitle="Success",this.dealSuccessDesc="Your Deal offer Submission "+this.basicForm.title+" has been successfully sent.",this.dealSuccessVisible=!0)})).catch((e=>(console.log(e),this.$loading().close(),e.msg?this.$message.error(e.msg):e.message?this.$message.error(e.message):void 0)))}}))},submitDealSuccess(){this.dealSuccessVisible=!1,this.$router.push("/deals/myDeals")},resetForm(e){this.$refs[e].resetFields()},discard(){this.$router.go(-1)}}},Y=t(48118);const E=(0,Y.Z)(J,[["render",x],["__scopeId","data-v-2a61bb69"]]);var K=E}}]);
//# sourceMappingURL=4764.5966f7aa.js.map