"use strict";(self["webpackChunkeslweb"]=self["webpackChunkeslweb"]||[]).push([[6145],{43755:function(e,s,a){var i=a(82482),t=a(41836);class o{constructor(){(0,i.Z)(this,"users",[{id:"08c0a6ec-a42b-47b2-bb1e-15e0f5f9a19a",name:"Mattie",password:"123",avatar:"/static/images/Avatar-1.png",email:"Mattie@goeasy.io",phone:"138xxxxxxxx"},{id:"3bb179af-bcc5-4fe0-9dac-c05688484649",name:"Wallace",password:"123",avatar:"/static/images/Avatar-2.png",email:"Wallace@goeasy.io",phone:"138xxxxxxxx"},{id:"fdee46b0-4b01-4590-bdba-6586d7617f95",name:"Tracy",password:"123",avatar:"/static/images/Avatar-3.png",email:"Tracy@goeasy.io",phone:"138xxxxxxxx"},{id:"33c3693b-dbb0-4bc9-99c6-fa77b9eb763f",name:"Juanita",password:"123",avatar:"/static/images/Avatar-4.png",email:"Juanita@goeasy.io",phone:"138xxxxxxxx"}]),(0,i.Z)(this,"groups",[{id:"group-a42b-47b2-bb1e-15e0f5f9a19a",name:"小程序交流群",avatar:"/static/images/wx.png",userList:["08c0a6ec-a42b-47b2-bb1e-15e0f5f9a19a","3bb179af-bcc5-4fe0-9dac-c05688484649","fdee46b0-4b01-4590-bdba-6586d7617f95","33c3693b-dbb0-4bc9-99c6-fa77b9eb763f"]},{id:"group-4b01-4590-bdba-6586d7617f95",name:"UniApp交流群",avatar:"/static/images/uniapp.png",userList:["08c0a6ec-a42b-47b2-bb1e-15e0f5f9a19a","fdee46b0-4b01-4590-bdba-6586d7617f95","33c3693b-dbb0-4bc9-99c6-fa77b9eb763f"]},{id:"group-dbb0-4bc9-99c6-fa77b9eb763f",name:"GoEasy交流群",avatar:"/static/images/goeasy.jpeg",userList:["08c0a6ec-a42b-47b2-bb1e-15e0f5f9a19a","3bb179af-bcc5-4fe0-9dac-c05688484649"]}]),(0,i.Z)(this,"orders",[{id:"252364104325",url:"/static/images/goods1-1.jpg",name:"青桔柠檬气泡美式",price:"￥23",count:1},{id:"251662058022",url:"/static/images/goods1-2.jpg",name:"咸柠七",price:"￥8",count:2},{id:"250676186141",url:"/static/images/goods1-3.jpg",name:"黑糖波波鲜奶茶",price:"￥12",count:1}])}findUsers(){return this.users}async findFriends(){let e={identity:1},s=await(0,t.ky)(e);return s.message}findGroups(e){return this.groups.filter((s=>s.userList.find((s=>s===e.id))))}findUser(e,s){return this.users.find((a=>a.name===e&&a.password===s))}getOrderList(){return this.orders}findGroupById(e){return this.groups.find((s=>s.id===e))}findUserById(e,s,a){let i={user_id:e,identity:s,company_id:a},o={};return(0,t.Vd)(i).then((e=>{if(200==e.code){let a="",i="https://oss.esl-passport.cn/educator.png";if(1==s){let s=e.message.user_contact;s&&(a=s.first_name+""+s.last_name,s.headimgurl&&(i=s.headimgurl))}if(2==s||3==s||4==s||5==s){let s=e.message.user_contact.company;s&&(a=s.display_name),s&&s.logo&&(i=s.logo)}o={name:a,avatar:i}}else console.log("获取用户信息失败")})).catch((e=>{console.log(e)})),o}findGroupMembers(e){let s=[],a=this.groups.find((s=>s.id===e));return this.users.map((e=>{a.userList.find((s=>s===e.id)),s.push(e)})),s}findGroupMemberAvatars(e){let s=[],a=this.groups.find((s=>s.id===e));return this.users.map((e=>{a.userList.forEach((a=>{e.id===a&&s.push(e.avatar)}))})),s}}s["Z"]=new o},61241:function(e,s,a){var i=a(82482);class t{constructor(e,s){(0,i.Z)(this,"emojiMap",null),(0,i.Z)(this,"url",""),(0,i.Z)(this,"patterns",[]),(0,i.Z)(this,"metaChars",/[[\]{}()*+?.\\|^$\-,&#\s]/g),this.url=e||"",this.emojiMap=s||{};for(let a in this.emojiMap)this.emojiMap.hasOwnProperty(a)&&this.patterns.push("("+a.replace(this.metaChars,"\\$&")+")")}decode(e){return e.replace(new RegExp(this.patterns.join("|"),"g"),(e=>"undefined"!=typeof this.emojiMap[e]?'<img height="25px" width="25px" src="'+this.url+this.emojiMap[e]+'" />':e))}}s["Z"]=t},78283:function(e,s,a){a.d(s,{Dk:function(){return n},ie:function(){return o},p6:function(){return t}});var i=a(44276);function t(e){e=e||Date.now();let s=new Date(e),a=s.getMonth()<9?"0"+(s.getMonth()+1):s.getMonth()+1;return a+="-",a+=s.getDate()<10?"0"+s.getDate():s.getDate(),a+=" ",a+=s.getHours(),a+=":",a+=s.getMinutes()<10?"0"+s.getMinutes():s.getMinutes(),a}function o(e){return encodeURIComponent((0,i.cv)(e))}function n(e){return(0,i.Jx)(decodeURIComponent(e))}},52208:function(e,s,a){a.d(s,{Z:function(){return p}});var i=a(66252),t=a(56612),o=a(62931);const n=e=>((0,i.dD)("data-v-a4c6ba24"),e=e(),(0,i.Cn)(),e),l=["src"],r=n((()=>(0,i._)("div",{class:"icon"},null,-1))),c={key:0,class:"video-player"},d=["src"];var u={__name:"GoEasyVideoPlayer",props:{src:String,thumbnail:{}},setup(e){const s=200,a=150,n=(0,o.iH)(!1);function u(e,i){return e<s&&i<a?i:e>i?s/e*i:e===i||e<i?a:void 0}function g(){n.value=!0}function m(){n.value=!1}return(s,a)=>((0,i.wg)(),(0,i.iD)("div",null,[(0,i._)("div",{class:"content-video",onClick:g},[(0,i._)("img",{src:e.thumbnail.url,style:(0,t.j5)({height:u(e.thumbnail.width,e.thumbnail.height)+"px"})},null,12,l),r]),n.value?((0,i.wg)(),(0,i.iD)("div",c,[(0,i._)("video",{src:e.src,autoplay:"",controls:""},null,8,d),(0,i._)("span",{class:"close-player",onClick:m},"x")])):(0,i.kq)("",!0)]))}},g=a(48118);const m=(0,g.Z)(u,[["__scopeId","data-v-a4c6ba24"]]);var p=m},6145:function(e,s,a){a.r(s),a.d(s,{default:function(){return Ye}});var i=a(66252);const t={preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 16 16",width:"1.2em",height:"1.2em"},o=(0,i._)("path",{fill:"currentColor",d:"M10.404 5.11L9.389 4.096L4.314 9.17a2.152 2.152 0 1 0 3.045 3.044l6.09-6.089a3.588 3.588 0 0 0-5.075-5.074L1.98 7.444l-.014.013c-1.955 1.955-1.955 5.123 0 7.077s5.123 1.954 7.078 0l.013-.014l.001.001l4.365-4.364l-1.015-1.014l-4.365 4.363l-.013.013a3.573 3.573 0 0 1-5.048 0a3.572 3.572 0 0 1 .014-5.06l-.001-.001L9.39 2.065c.839-.84 2.205-.84 3.045 0s.839 2.205 0 3.044l-6.09 6.089a.718.718 0 0 1-1.015-1.014l5.075-5.075z"},null,-1),n=[o];function l(e,s){return(0,i.wg)(),(0,i.iD)("svg",t,n)}var r={name:"icomoon-free-attachment",render:l};const c={preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},d=(0,i._)("path",{fill:"currentColor",d:"M21 7L9 19l-5.5-5.5l1.41-1.41L9 16.17L19.59 5.59L21 7Z"},null,-1),u=[d];function g(e,s){return(0,i.wg)(),(0,i.iD)("svg",c,u)}var m={name:"mdi-tick",render:g};const p={preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},A=(0,i._)("path",{fill:"currentColor",d:"M.41 13.41L6 19l1.41-1.42L1.83 12m20.41-6.42L11.66 16.17L7.5 12l-1.43 1.41L11.66 19l12-12M18 7l-1.41-1.42l-6.35 6.35l1.42 1.41L18 7Z"},null,-1),f=[A];function v(e,s){return(0,i.wg)(),(0,i.iD)("svg",p,f)}var h={name:"mdi-tick-all",render:v};const y={preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},w=(0,i._)("path",{fill:"currentColor",d:"m12 20l-8-8l8-8l1.425 1.4l-5.6 5.6H20v2H7.825l5.6 5.6Z"},null,-1),b=[w];function M(e,s){return(0,i.wg)(),(0,i.iD)("svg",y,b)}var k={name:"material-symbols-arrow-back",render:M},x=a(56612),C=a(58061);const _=e=>((0,i.dD)("data-v-79e19d95"),e=e(),(0,i.Cn)(),e),E={class:"chat-container"},D={class:"chat-title"},I={class:"chat-back-btn"},j={class:"chat-name"},P={class:"chat-main",ref:"scrollView"},S={class:"message-list",ref:"messageList"},F={key:0,class:"history-loading"},L={class:"time-tips"},B={key:0,class:"message-recalled"},Q={key:0},q={key:1,class:"message-recalled-self"},Z=_((()=>(0,i._)("div",null,"you retracted a message",-1))),U=["onClick"],R={key:1,class:"message-item"},W={key:0,class:"message-item-checkbox"},T=["value"],V={class:"sender-info"},G=["onContextmenu"],z={class:"message-payload"},O={key:0,class:"pending"},H={key:1,class:"send-fail"},J=["innerHTML"],Y=["onClick"],K=["href"],N={class:"content-file",title:"click download"},X={class:"file-info"},$={class:"file-name"},ee={class:"file-size"},se=["onClick"],ae=_((()=>(0,i._)("span",null,'"',-1))),ie={key:7,class:"content-order"},te={class:"order-id"},oe={class:"order-body"},ne={class:"order-name"},le={class:"order-price"},re={class:"order-count"},ce={key:0},de={class:"chat-footer"},ue={key:0,class:"action-delete"},ge=_((()=>(0,i._)("div",null,"delete",-1))),me={key:1,class:"action-box"},pe={class:"action-bar"},Ae={class:"action-item"},fe={key:0,class:"emoji-box"},ve={class:"action-item"},he={for:"file-input"},ye={class:"input-box"},we={class:"send-box"},be=(0,i.Uk)(" Send "),Me={key:0,class:"image-preview"},ke={class:"action-popup-main"},xe={key:2,class:"order-box"},Ce={class:"order-list"},_e={class:"title"},Ee=_((()=>(0,i._)("div",null,"请选择一个订单",-1))),De=["onClick"],Ie={class:"order-id"},je={class:"order-body"},Pe={class:"order-name"},Se={class:"order-price"},Fe={class:"order-count"};function Le(e,s,a,t,o,n){const l=k,c=(0,i.up)("el-icon"),d=(0,i.up)("el-button"),u=(0,i.up)("el-avatar"),g=(0,i.up)("el-image"),p=(0,i.up)("goeasy-video-player"),A=h,f=m,v=r;return(0,i.wg)(),(0,i.iD)("div",E,[(0,i._)("div",D,[(0,i._)("div",I,[(0,i.Wm)(d,{link:"",onClick:s[0]||(s[0]=e=>t.backToConversations())},{default:(0,i.w5)((()=>[(0,i.Wm)(c,{size:20},{default:(0,i.w5)((()=>[(0,i.Wm)(l)])),_:1})])),_:1})]),(0,i.Wm)(u,{src:t.friend.avatar,class:"chat-avatar"},null,8,["src"]),(0,i._)("div",j,(0,x.zw)(t.friend.name),1)]),(0,i._)("div",P,[(0,i._)("div",S,[t.history.loading?((0,i.wg)(),(0,i.iD)("div",F,[(0,i.Wm)(g,{src:o.pendingGif},null,8,["src"])])):((0,i.wg)(),(0,i.iD)("div",{key:1,class:(0,x.C_)(t.history.allLoaded?"history-loaded":"load"),onClick:s[1]||(s[1]=e=>t.loadHistoryMessage(!1))},(0,x.zw)(t.history.allLoaded?"History has no more messages":"Click to get history messages"),3)),((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(t.history.messages,((a,n)=>((0,i.wg)(),(0,i.iD)("div",{key:n},[(0,i._)("div",L,(0,x.zw)(t.renderMessageDate(a,n)),1),a.recalled?((0,i.wg)(),(0,i.iD)("div",B,[a.senderId!==t.currentUser.uuid?((0,i.wg)(),(0,i.iD)("div",Q,(0,x.zw)(t.friend.name)+" retracted a message ",1)):((0,i.wg)(),(0,i.iD)("div",q,[Z,"text"===a.type&&Date.now()-a.timestamp<6e4?((0,i.wg)(),(0,i.iD)("span",{key:0,onClick:e=>t.editRecalledMessage(a.payload.text)}," re-edit ",8,U)):(0,i.kq)("",!0)]))])):((0,i.wg)(),(0,i.iD)("div",R,[t.messageSelector.visible&&"sending"!==a.status?((0,i.wg)(),(0,i.iD)("div",W,[(0,i.wy)((0,i._)("input",{class:"input-checkbox",type:"checkbox",value:a.messageId,"onUpdate:modelValue":s[2]||(s[2]=e=>t.messageSelector.ids=e),onClick:s[3]||(s[3]=(...e)=>t.selectMessages&&t.selectMessages(...e))},null,8,T),[[C.e8,t.messageSelector.ids]])])):(0,i.kq)("",!0),(0,i._)("div",{class:(0,x.C_)(["message-item-content",{self:a.senderId===t.currentUser.uuid}])},[(0,i._)("div",V,[t.currentUser.uuid===a.senderId?((0,i.wg)(),(0,i.j4)(u,{key:0,src:t.currentUser.avatar,class:"sender-avatar"},null,8,["src"])):((0,i.wg)(),(0,i.j4)(u,{key:1,src:t.friend.avatar,class:"sender-avatar"},null,8,["src"]))]),(0,i._)("div",{class:"message-content",onContextmenu:(0,C.iM)((e=>t.showActionPopup(a)),["prevent","stop"])},[(0,i._)("div",z,["sending"===a.status?((0,i.wg)(),(0,i.iD)("div",O)):(0,i.kq)("",!0),"fail"===a.status?((0,i.wg)(),(0,i.iD)("div",H)):(0,i.kq)("",!0),"text"===a.type?((0,i.wg)(),(0,i.iD)("div",{key:2,class:(0,x.C_)(t.currentUser.uuid===a.senderId?"content-text":"content-text-1"),innerHTML:t.emoji.decoder.decode(a.payload.text)},null,10,J)):(0,i.kq)("",!0),"image"===a.type?((0,i.wg)(),(0,i.iD)("div",{key:3,class:"content-image",onClick:e=>t.showImagePreviewPopup(a.payload.url)},[(0,i.Wm)(g,{src:a.payload.url,style:(0,x.j5)({height:t.getImageHeight(a.payload.width,a.payload.height)+"px"})},null,8,["src","style"])],8,Y)):(0,i.kq)("",!0),"file"===a.type?((0,i.wg)(),(0,i.iD)("a",{key:4,href:a.payload.url,target:"_blank",download:"download"},[(0,i._)("div",N,[(0,i._)("div",X,[(0,i._)("span",$,(0,x.zw)(a.payload.name),1),(0,i._)("span",ee,(0,x.zw)((a.payload.size/1024).toFixed(2))+"KB",1)]),(0,i.Wm)(g,{class:"file-img",src:o.fileIconImg},null,8,["src"])])],8,K)):(0,i.kq)("",!0),"audio"===a.type?((0,i.wg)(),(0,i.iD)("div",{key:5,class:"content-audio",onClick:e=>t.playAudio(a)},[(0,i._)("div",{class:"audio-facade",style:(0,x.j5)({width:7*Math.ceil(a.payload.duration)+50+"px"})},[(0,i._)("div",{class:(0,x.C_)(["audio-facade-bg",{"play-icon":e.audioPlayer.playingMessage===a}])},null,2),(0,i._)("div",null,[(0,i.Uk)((0,x.zw)(Math.ceil(a.payload.duration)||1),1),ae])],4)],8,se)):(0,i.kq)("",!0),"video"===a.type?((0,i.wg)(),(0,i.j4)(p,{key:6,thumbnail:a.payload.thumbnail,src:a.payload.video.url},null,8,["thumbnail","src"])):(0,i.kq)("",!0),"order"===a.type?((0,i.wg)(),(0,i.iD)("div",ie,[(0,i._)("div",te,"订单号："+(0,x.zw)(a.payload.id),1),(0,i._)("div",oe,[(0,i.Wm)(g,{src:a.payload.url,class:"order-img"},null,8,["src"]),(0,i._)("div",ne,(0,x.zw)(a.payload.name),1),(0,i._)("div",null,[(0,i._)("div",le,(0,x.zw)(a.payload.price),1),(0,i._)("div",re,"共"+(0,x.zw)(a.payload.count)+"件",1)])])])):(0,i.kq)("",!0)]),t.currentUser.uuid===a.senderId?((0,i.wg)(),(0,i.iD)("div",{key:0,class:(0,x.C_)(a.read?"message-read":"message-unread")},[a.senderId===t.currentUser.uuid?((0,i.wg)(),(0,i.iD)("div",ce,[a.read?((0,i.wg)(),(0,i.j4)(c,{key:0,size:12},{default:(0,i.w5)((()=>[(0,i.Wm)(A)])),_:1})):((0,i.wg)(),(0,i.j4)(c,{key:1,size:12},{default:(0,i.w5)((()=>[(0,i.Wm)(f)])),_:1}))])):(0,i.kq)("",!0)],2)):(0,i.kq)("",!0)],40,G)],2)]))])))),128))],512)],512),(0,i._)("div",de,[t.messageSelector.visible?((0,i.wg)(),(0,i.iD)("div",ue,[(0,i.Wm)(g,{class:"delete-btn",src:o.deleteImg,onClick:t.deleteMultipleMessages},null,8,["src","onClick"]),ge])):((0,i.wg)(),(0,i.iD)("div",me,[(0,i._)("div",pe,[(0,i._)("div",Ae,[t.emoji.visible?((0,i.wg)(),(0,i.iD)("div",fe,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(t.emoji.map,((e,s,a)=>((0,i.wg)(),(0,i.j4)(g,{class:"emoji-item",key:a,src:t.emoji.url+e,onClick:e=>t.chooseEmoji(s)},null,8,["src","onClick"])))),128))])):(0,i.kq)("",!0),(0,i._)("i",{class:"iconfont icon-smile",title:"emoji",onClick:s[4]||(s[4]=(...e)=>t.showEmojiBox&&t.showEmojiBox(...e))})]),(0,i._)("div",ve,[(0,i._)("label",he,[(0,i.Wm)(c,{size:25},{default:(0,i.w5)((()=>[(0,i.Wm)(v)])),_:1})]),(0,i.wy)((0,i._)("input",{id:"file-input",type:"file",onChange:s[5]||(s[5]=(...e)=>t.sendFileMessage&&t.sendFileMessage(...e))},null,544),[[C.F8,!1]])])]),(0,i._)("div",ye,[(0,i.wy)((0,i._)("textarea",{ref:"input","onUpdate:modelValue":s[6]||(s[6]=e=>t.text=e),maxlength:"700",autocomplete:"off",placeholder:"Type your message here",onKeyup:s[7]||(s[7]=(0,C.D2)((0,C.iM)(((...e)=>t.sendTextMessage&&t.sendTextMessage(...e)),["shift"]),["enter"])),class:"input-content"},"\r\n          ",544),[[C.nr,t.text]])]),(0,i._)("div",we,[(0,i.Wm)(d,{link:"",type:"primary",onClick:t.sendTextMessage},{default:(0,i.w5)((()=>[be])),_:1},8,["onClick"])])]))]),(0,i._)("audio",{ref:"audioPlayer.audio",onEnded:s[8]||(s[8]=(...e)=>t.onAudioPlayEnd&&t.onAudioPlayEnd(...e)),onPause:s[9]||(s[9]=(...e)=>t.onAudioPlayEnd&&t.onAudioPlayEnd(...e))},null,544),t.imagePreview.visible?((0,i.wg)(),(0,i.iD)("div",Me,[(0,i.Wm)(g,{src:t.imagePreview.url,alt:"image"},null,8,["src"]),(0,i._)("span",{class:"close",onClick:s[10]||(s[10]=(...e)=>t.hideImagePreviewPopup&&t.hideImagePreviewPopup(...e))},"×")])):(0,i.kq)("",!0),t.actionPopup.visible?((0,i.wg)(),(0,i.iD)("div",{key:1,class:"action-popup",onClick:s[15]||(s[15]=e=>t.actionPopup.visible=!1)},[(0,i._)("div",ke,[(0,i._)("div",{class:"action-item",onClick:s[11]||(s[11]=(...e)=>t.deleteSingleMessage&&t.deleteSingleMessage(...e))},"Delete"),t.actionPopup.recallable?((0,i.wg)(),(0,i.iD)("div",{key:0,class:"action-item",onClick:s[12]||(s[12]=(...e)=>t.recallMessage&&t.recallMessage(...e))},"Retract")):(0,i.kq)("",!0),(0,i._)("div",{class:"action-item",onClick:s[13]||(s[13]=(...e)=>t.showCheckBox&&t.showCheckBox(...e))},"Multiple choice"),(0,i._)("div",{class:"action-item",onClick:s[14]||(s[14]=e=>t.actionPopup.visible=!1)},"Cancel")])])):(0,i.kq)("",!0),t.orderList.visible?((0,i.wg)(),(0,i.iD)("div",xe,[(0,i._)("div",Ce,[(0,i._)("div",_e,[Ee,(0,i._)("span",{onClick:s[16]||(s[16]=(...e)=>t.closeOrderMessageList&&t.closeOrderMessageList(...e))},"×")]),((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(t.orderList.orders,((e,s)=>((0,i.wg)(),(0,i.iD)("div",{key:s,class:"order-item",onClick:s=>t.sendOrderMessage(e)},[(0,i._)("div",Ie,"订单号："+(0,x.zw)(e.id),1),(0,i._)("div",je,[(0,i.Wm)(g,{src:e.url,class:"order-img"},null,8,["src"]),(0,i._)("div",Pe,(0,x.zw)(e.name),1),(0,i._)("div",null,[(0,i._)("div",Se,(0,x.zw)(e.price),1),(0,i._)("div",Fe,"共"+(0,x.zw)(e.count)+"件",1)])])],8,De)))),128))])])):(0,i.kq)("",!0)])}var Be=a(9936),Qe=a(30003),qe=a(33927),Ze=a(62931),Ue=a(28339),Re=a(33907),We=a(78283),Te=a(43755),Ve=a(61241),Ge=a(52208),ze=a(44276),Oe={name:"chatPrivateChat",components:{GoeasyVideoPlayer:Ge.Z},setup(){const e=(0,Ue.yj)(),s=(0,Ue.tv)(),a=(0,Re.oR)(),t=(0,i.f3)("GoEasy"),o=(0,i.f3)("goEasy"),n=a.state.currentUser,l=200,r=150,c="https://imgcache.qq.com/open/qcloud/tim/assets/emoji/",d={"[么么哒]":"emoji_3@2x.png","[乒乓]":"emoji_4@2x.png","[便便]":"emoji_5@2x.png","[信封]":"emoji_6@2x.png","[偷笑]":"emoji_7@2x.png","[傲慢]":"emoji_8@2x.png"};let u=decodeURI(e.query.str),g=JSON.parse((0,ze.Jx)(u)),m=(0,Ze.iH)({id:g.uuid,name:g.name,avatar:g.avatar}),p={id:m.value.id,type:t.IM_SCENE.PRIVATE,data:{name:m.value.name,avatar:m.value.avatar}},A=(0,Ze.qj)({messages:[],allLoaded:!1,loading:!0}),f=(0,Ze.iH)(""),v=(0,Ze.qj)({url:c,map:d,visible:!1,decoder:new Ve.Z(c,d)}),h=(0,Ze.qj)({orders:[],visible:!1}),y=(0,Ze.qj)({visible:!1,url:""}),w=(0,Ze.qj)({audio:{},playingMessage:null}),b=(0,Ze.qj)({visible:!1,message:null,recallable:!1}),M=(0,Ze.qj)({visible:!1,ids:[]});function k(e){e.senderId===m.value.id&&(A.messages.push(e),J()),N()}function x(e,s){return e<l&&s<r?s:e>s?l/e*s:e===s||e<s?r:void 0}function C(e){let s=w.playingMessage;s&&(w.audio.pause(),s===e)||(w.playingMessage=e,w.audio.src=e.payload.url,w.audio.load(),w.audio.currentTime=0,w.audio.play())}function _(){w.playingMessage=null}function E(){f.value.trim()?o.im.createTextMessage({text:f.value,to:p,onSuccess:e=>{Q(e),f.value=""},onFailed:e=>{console.log("创建消息err:",e)}}):console.log("输入为空")}function D(){v.visible=!v.visible}function I(e){f.value+=e,v.visible=!1}function j(e){let s=[...e.target.files];s.forEach((e=>{o.im.createImageMessage({file:e,to:p,onProgress:function(e){console.log(e)},onSuccess:e=>{Q(e)},onFailed:e=>{console.log("error :",e)}})}))}function P(e){const s=e.target.files[0];o.im.createVideoMessage({file:s,to:p,onProgress:function(e){console.log(e)},onSuccess:e=>{Q(e)},onFailed:e=>{console.log("error :",e)}})}function S(e){const s=e.target.files[0];o.im.createFileMessage({file:s,to:p,onProgress:function(e){console.log(e)},onSuccess:e=>{Q(e)},onFailed:e=>{console.log("error :",e)}})}function F(){h.visible=!1}function L(){h.orders=Te.Z.getOrderList(),h.visible=!0}function B(e){h.visible=!1,o.im.createCustomMessage({type:"order",payload:e,to:p,onSuccess:e=>{Q(e)},onFailed:e=>{console.log("创建消息err:",e)}})}function Q(e){let s=(0,Ze.iH)();s.value=e,A.messages.push(s.value),N(),o.im.sendMessage({message:s.value,onSuccess:e=>{console.log("发送成功",e)},onFailed:function(e){507===e.code?(alert("发送语音/图片/视频/文件失败，没有配置OSS存储"),console.log("发送语音/图片/视频/文件失败，没有配置OSS存储，详情参考：https://www.goeasy.io/cn/docs/goeasy-2.x/im/message/media/send-media-message.html")):console.log("发送失败:",e)}})}function q(e){const s=18e4;M.ids=[e.messageId],Date.now()-e.timestamp<s&&e.senderId===n.id&&"success"===e.status?b.recallable=!0:b.recallable=!1,b.visible=!0}function Z(){b.visible=!1,R()}function U(){M.ids.length>0&&(M.visible=!1,R())}function R(){let e=confirm("确认删除？");if(!0===e){let e=[];A.messages.forEach((s=>{M.ids.includes(s.messageId)&&e.push(s)})),o.im.deleteMessage({messages:e,onSuccess:()=>{e.forEach((e=>{let s=A.messages.indexOf(e);s>-1&&A.messages.splice(s,1)})),M.ids=[]},onFailed:e=>{console.log("error:",e)}})}else M.ids=[]}function W(){let e=[];A.messages.forEach((s=>{M.ids.includes(s.messageId)&&e.push(s)})),b.visible=!1,o.im.recallMessage({messages:e,onSuccess:()=>{console.log("撤回成功")},onFailed:e=>{console.log("撤回失败,error:",e)}})}function T(e){f.value=e}function V(e){y.visible=!0,y.url=e}function G(){y.visible=!1}function z(){M.ids=[],M.visible=!0,b.visible=!1}function O(e){if(e.target.checked)M.ids.push(e.target.value);else{let s=M.ids.indexOf(e.target.value);s>-1&&M.ids.splice(s,1)}}function H(e){let s;A.loading=!0;let a=A.messages[0];a&&(s=a.timestamp),o.im.history({userId:m.value.id,lastTimestamp:s,limit:10,onSuccess:a=>{A.loading=!1;let i=(0,Ze.qj)([]);i.push(...a.content),0===i.length?A.allLoaded=!0:(s?(i.push(...A.messages),A.messages=i):A.messages=i,i.length<10&&(A.allLoaded=!0),e&&(N(),J()))},onFailed:e=>{A.loading=!1,console.log("获取历史消息失败, code:"+e.code+",错误信息:"+e.content)}})}function J(){o.im.markMessageAsRead({id:p.id,type:p.type,onSuccess:function(){console.log("标记私聊已读成功")},onFailed:function(e){console.log("标记私聊已读失败",e)}})}let Y=(0,Ze.iH)(),K=(0,Ze.iH)();function N(){(0,i.Y3)((()=>{Y.value.scrollTop=K.value.scrollHeight}))}function X(e,s){return 0===s||e.timestamp-A.messages[s-1].timestamp>3e5?(0,We.p6)(e.timestamp):""}function $(){s.push({path:"/chat/messages"})}return(0,i.wF)((()=>{H(!0),o.im.on(t.IM_EVENT.PRIVATE_MESSAGE_RECEIVED,k)})),(0,i.Jd)((()=>{o.im.off(t.IM_EVENT.PRIVATE_MESSAGE_RECEIVED,k)})),{currentUser:n,friend:m,messageSelector:M,orderList:h,emoji:v,actionPopup:b,imagePreview:y,text:f,history:A,scrollView:Y,messageList:K,getImageHeight:x,playAudio:C,onAudioPlayEnd:_,sendTextMessage:E,showEmojiBox:D,chooseEmoji:I,sendImageMessage:j,sendVideoMessage:P,sendFileMessage:S,closeOrderMessageList:F,showOrderMessageList:L,sendOrderMessage:B,sendMessage:Q,showActionPopup:q,deleteSingleMessage:Z,deleteMultipleMessages:U,deleteMessage:R,recallMessage:W,editRecalledMessage:T,showImagePreviewPopup:V,hideImagePreviewPopup:G,showCheckBox:z,selectMessages:O,loadHistoryMessage:H,renderMessageDate:X,backToConversations:$}},data(){return{deleteImg:Be,pendingGif:Qe,fileIconImg:qe}}},He=a(48118);const Je=(0,He.Z)(Oe,[["render",Le],["__scopeId","data-v-79e19d95"]]);var Ye=Je},9936:function(e){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAAXNSR0IArs4c6QAAAoBJREFUeF7tm79uFDEQxj/fU3juiEQJBIkCmnR5ATqIaELJaxAeI5TQIHiIHIISCgr+dFBwN5Z4hzPa6E7a7IV4xx5vtNxcuTs7/vzzeGa9Zzvs+M/teP9hACwCFAkQ0bFz7mGM8QDADUXXjatfAD4A+MjML7V8q02B6XT6Nsb4WEtYws9nZn6g0ZYKACL6BOC+hqC+Ppxz75bL5VFf+3/ZFQMgomcATkuFZD7/lJlfZz57/pgGgFcAjjciYowvAMxDCPMSYd1nvfd3ABw5555v7mlEgQaAnwButgDshxC+aXZ+48t7f+icO2v5/s3MeyVtaQCIbQHMXOzzqg4RkWp7xWK1BaVGU7s9A5AinrqvPSJDt7cVAd77E+fcIwD7KTEjuz+PMb4PIZy0dW8BIKImyx6OrHN95X5l5rsGoEXApkDf2Plf7YrL4NjBGICxj2CpfnEEtN4T/lxWV7uCZrPZvdVq9aa5PplMniwWiy9XiZbarxdI5yvEZiUqXYWKAXTeE7bqardzRPQdwK319R/MfDux2JHat99bxF+KcgCIVmPSV+Xa9l34BkCaRGqPUG3/FgEdAjYFbAoICdSeo7X9Ww6wHHCRgCVBYQpA7Tla27/lAMsBlgMuELAkaElQSKB2lq7t36qAVQGrAlYF2gSsDAqLQM5aQPqZW2ov+ko9eBWQ/tEhtZeWzcEBSCNMam8ACrfNVU+C0hGV2lsEWASU7Ry1KZAx5wbbHJ3SprF5OicCBtke36PzKtvncwBc5wGJFBfxAQoxgEbBdRyRSfU89/BEFoBGzMCHpFL9F2+N2TjMBrCOhJrH5FKdVjlGVwQgpXAM9w3AGEappsadj4C/PwmZX53qGlwAAAAASUVORK5CYII="},33927:function(e,s,a){e.exports=a.p+"img/file-icon.25ae8925.png"},30003:function(e){e.exports="data:image/gif;base64,R0lGODlhEAAQALMMAKqooJGOhp2bk7e1rZ2bkre1rJCPhqqon8PBudDOxXd1bISCef///wAAAAAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh+QQFAAAMACwAAAAAEAAQAAAET5DJyYyhmAZ7sxQEs1nMsmACGJKmSaVEOLXnK1PuBADepCiMg/DQ+/2GRI8RKOxJfpTCIJNIYArS6aRajWYZCASDa41Ow+Fx2YMWOyfpTAQAIfkEBQAADAAsAAAAABAAEAAABE6QyckEoZgKe7MEQMUxhoEd6FFdQWlOqTq15SlT9VQM3rQsjMKO5/n9hANixgjc9SQ/CgKRUSgw0ynFapVmGYkEg3v1gsPibg8tfk7CnggAIfkEBQAADAAsAAAAABAAEAAABE2QycnOoZjaA/IsRWV1goCBoMiUJTW8A0XMBPZmM4Ug3hQEjN2uZygahDyP0RBMEpmTRCKzWGCkUkq1SsFOFQrG1tr9gsPc3jnco4A9EQAh+QQFAAAMACwAAAAAEAAQAAAETpDJyUqhmFqbJ0LMIA7McWDfF5LmAVApOLUvLFMmlSTdJAiM3a73+wl5HYKSEET2lBSFIhMIYKRSimFriGIZiwWD2/WCw+Jt7xxeU9qZCAAh+QQFAAAMACwAAAAAEAAQAAAETZDJyRCimFqbZ0rVxgwF9n3hSJbeSQ2rCWIkpSjddBzMfee7nQ/XCfJ+OQYAQFksMgQBxumkEKLSCfVpMDCugqyW2w18xZmuwZycdDsRACH5BAUAAAwALAAAAAAQABAAAARNkMnJUqKYWpunUtXGIAj2feFIlt5JrWybkdSydNNQMLaND7pC79YBFnY+HENHMRgyhwPGaQhQotGm00oQMLBSLYPQ9QIASrLAq5x0OxEAIfkEBQAADAAsAAAAABAAEAAABE2QycmUopham+da1cYkCfZ94UiW3kmtbJuRlGF0E4Iwto3rut6tA9wFAjiJjkIgZAYDTLNJgUIpgqyAcTgwCuACJssAdL3gpLmbpLAzEQA7"},82482:function(e,s,a){function i(e,s,a){return s in e?Object.defineProperty(e,s,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[s]=a,e}a.d(s,{Z:function(){return i}})}}]);
//# sourceMappingURL=6145.01ce3b18.js.map